<!-- search.html -->
<div class="search-container" #searchContainer>
  <div class="relative">
    <input
      type="text"
      [(ngModel)]="query"
      (input)="onSearchInput()"
      (focus)="showResults = true"
      (blur)="onBlur()"
      placeholder="Search for movies or TV shows..."
      class="search-input"
    />
    <button
      (click)="onSearch()"
      [disabled]="isLoading"
      class="search-button"
    >
    @if (!isLoading) {

      <svg  class="search-icon" viewBox="0 0 24 24">
        <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
      </svg>
    }
    @if (isLoading) {

      <svg  class="loading-icon" viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="10" />
        <path d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" />
      </svg>
    }
    </button>

    <!-- Results Dropdown -->
    @if (showResults && query) {
      <div class="results-dropdown">
        @if (isLoading) {
          <div class="loading-message">Searching...</div>
        } @else if (searchResults.length > 0) {
          <div class="results-list">
            @for (item of searchResults; track item.id) {
              <div 
                class="result-item"
                (mousedown)="selectItem(item)"
              >
                <div class="result-title">{{ item.title || item.name }}</div>
                <div class="result-subtitle">
                  {{ item.media_type === 'movie' ? 'Movie' : 'TV Show' }}
                  @if (item.release_date || item.first_air_date) {
                    - {{ (item.release_date || item.first_air_date) | date:'mediumDate' }}
                  }
                </div>
              </div>
            }
          </div>
        } @else if (query && !isLoading) {
          <div class="no-results">No results found for "{{ query }}"</div>
        }
      </div>
    }
  </div>
</div>